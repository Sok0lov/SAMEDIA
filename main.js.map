{"version":3,"file":"main.js","mappings":"mBAKAA,SAASC,iBAAiB,oBAAoB,WAG5C,GAFcD,SAASE,cAAc,UAErC,CAEA,IAAMC,EAAaH,SAASI,eAAe,eACrCC,EAAYL,SAASI,eAAe,cACpCE,EAAeN,SAASI,eAAe,iBACvCG,EAASP,SAASI,eAAe,gBAEvCD,EAAWF,iBAAiB,UAAU,SAAUO,GAC5CA,EAAEC,iBAGFN,EAAWO,MAAMC,QAAU,OAC3BJ,EAAOG,MAAMC,QAAU,QAEvB,IAAMC,EAAWZ,SAASI,eAAe,YAAYS,MAC/CC,EAAWd,SAASI,eAAe,YAAYS,MAGrDP,EAAaS,YAAc,GAG3B,IAAMC,EAAS,0DAAHC,OAA6DL,EAAQ,cAAAK,OAAaH,GAG9FI,MAAMF,GACLG,MAAK,SAAAC,GAAQ,OAAIA,EAASC,MAAM,IAChCF,MAAK,SAAAG,GAKF,GAHAnB,EAAWO,MAAMC,QAAU,QAC3BJ,EAAOG,MAAMC,QAAU,OAEH,OAAhBW,EAAKC,OAAiB,CACxBC,QAAQC,IAAI,GACZ,IAAMC,EAAiB,IAAIC,KAC3BD,EAAeE,QAAQF,EAAeG,UAAY,GAG9C7B,SAAS8B,OAAS,SAAHb,OAAYK,EAAKS,MAAK,cAAAd,OAAaS,EAAeM,cAAa,YAGhF3B,EAAUK,MAAMC,QAAU,OAG1B,IAAMsB,EAAiBjC,SAASkC,cAAc,OAC9CD,EAAelB,YAAc,GAAHE,OAAMK,EAAKa,KAAKC,KAAI,8BAC9CH,EAAeI,UAAY,sBAG3B,IAAMC,EAAUtC,SAASkC,cAAc,UACvCI,EAAQvB,YAAc,8BACtBuB,EAAQD,UAAY,mCACpBC,EAAQC,KAAO,SAEfD,EAAQrC,iBAAiB,SAAS,WAChCuC,OAAOC,SAASC,KAAO,GACzB,IAGA,IAAMC,EAAiB3C,SAASE,cAAc,mBAC9CyC,EAAeC,YAAYX,GAC3BU,EAAeC,YAAYN,EAE/B,MAAO,GAAoB,UAAhBhB,EAAKC,OAAoB,CAElC,IAAMsB,EAAmB7C,SAASkC,cAAc,KAChDW,EAAiB9B,YAAcO,EAAKhB,aACpCuC,EAAiBR,UAAY,oBAC7B/B,EAAasC,YAAYC,GAEN7C,SAAS8C,iBAAiB,iBAClCC,SAAQ,SAAAC,GACjBA,EAAMtC,MAAMuC,OAAS,oBACrBD,EAAMtC,MAAMwC,MAAQ,SACtB,GACJ,MACE1B,QAAQC,IAAI,GAEVnB,EAAaS,YAAc,+BAEjC,IACCoC,OAAM,SAAAC,GAEHjD,EAAWO,MAAMC,QAAU,QAC3BJ,EAAOG,MAAMC,QAAU,OACvBa,QAAQC,IAAI,GAGZD,QAAQ4B,MAAM,UAAWA,EAC7B,GACJ,GAzFiB,CA0FnB,G","sources":["webpack://samedia/./src/index.js"],"sourcesContent":["import './scss/main.scss';\r\n\r\n\r\n\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", function () {\r\n  const login = document.querySelector(\".login\");\r\n\r\n  if(!login) return;\r\n\r\n  const loginInner = document.getElementById(\"login-inner\");\r\n  const loginForm = document.getElementById(\"login-form\");\r\n  const errorMessage = document.getElementById(\"error-message\");\r\n  const loader = document.getElementById(\"login-loader\");\r\n\r\n  loginInner.addEventListener(\"submit\", function (e) {\r\n      e.preventDefault();\r\n\r\n      // Дизейбл формы и отобразите прелоадер\r\n      loginInner.style.display = \"none\";\r\n      loader.style.display = \"block\";\r\n\r\n      const username = document.getElementById(\"username\").value;\r\n      const password = document.getElementById(\"password\").value;\r\n\r\n      // Скройте предыдущие сообщения об ошибках\r\n      errorMessage.textContent = \"\";\r\n\r\n      // Создайте URL для GET-запроса\r\n      const apiUrl = `https://test-works.pr-uni.ru/api/login/index.php?login=${username}&password=${password}`;\r\n\r\n      // Добавьте логику для обработки ошибок\r\n      fetch(apiUrl)\r\n      .then(response => response.json())\r\n      .then(data => {\r\n          // Восстановите состояние формы и скройте прелоадер\r\n          loginInner.style.display = \"block\";\r\n          loader.style.display = \"none\";\r\n         \r\n          if (data.status === \"ok\") {\r\n            console.log(5)\r\n            const expirationDate = new Date();\r\n            expirationDate.setDate(expirationDate.getDate() + 7); // Установите срок действия на 7 дней\r\n              // Сохраните токен в куки (не забудьте обеспечить безопасное хранение)\r\n              \r\n                document.cookie = `token=${data.token}; expires=${expirationDate.toUTCString()}; path=/`;\r\n\r\n              // Скройте форму\r\n              loginForm.style.display = \"none\";\r\n\r\n              // Выведите сообщение об успешной авторизации\r\n              const successMessage = document.createElement(\"div\");\r\n              successMessage.textContent = `${data.user.name}, Вы успешно авторизованы!`;\r\n              successMessage.className = 'login__sucsess-text'\r\n\r\n                  // Создайте элемент ссылки\r\n              const homeBtn = document.createElement(\"button\");\r\n              homeBtn.textContent = \"Перейти на главную страницу\";\r\n              homeBtn.className = 'login__button-home login__button'\r\n              homeBtn.type = \"button\";\r\n\r\n              homeBtn.addEventListener('click', function() {\r\n                window.location.href = '/';\r\n              });\r\n\r\n\r\n              const loginContainer = document.querySelector(\".login__sucsess\");\r\n              loginContainer.appendChild(successMessage);\r\n              loginContainer.appendChild(homeBtn);\r\n\r\n          } else if (data.status === \"error\") {\r\n\r\n            const errorMessageText = document.createElement(\"p\");\r\n            errorMessageText.textContent = data.errorMessage;\r\n            errorMessageText.className = 'login__error-text'\r\n            errorMessage.appendChild(errorMessageText);\r\n\r\n            const loginInput = document.querySelectorAll('.login__input');\r\n            loginInput.forEach(input => {\r\n              input.style.border = '1px solid #F65454';\r\n              input.style.color = '#F65454';\r\n            });\r\n        } else {\r\n          console.log(3)\r\n            // Обработка других статусов\r\n            errorMessage.textContent = \"Произошла неизвестная ошибка.\";\r\n        } \r\n      })\r\n      .catch(error => {\r\n          // Восстановите состояние формы и скройте прелоадер\r\n          loginInner.style.display = \"block\";\r\n          loader.style.display = \"none\";\r\n          console.log(4)\r\n\r\n          // Обработка ошибки запроса...\r\n          console.error('Ошибка:', error);\r\n      });\r\n  });\r\n});"],"names":["document","addEventListener","querySelector","loginInner","getElementById","loginForm","errorMessage","loader","e","preventDefault","style","display","username","value","password","textContent","apiUrl","concat","fetch","then","response","json","data","status","console","log","expirationDate","Date","setDate","getDate","cookie","token","toUTCString","successMessage","createElement","user","name","className","homeBtn","type","window","location","href","loginContainer","appendChild","errorMessageText","querySelectorAll","forEach","input","border","color","catch","error"],"sourceRoot":""}